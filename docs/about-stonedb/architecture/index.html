<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-about-stonedb/architecture">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="alternate" type="application/rss+xml" href="/community/rss.xml" title="StoneDB RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/community/atom.xml" title="StoneDB Atom Feed">
<link rel="icon" href="/img/stoneDB.png">
<link rel="manifest" href="/manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/img/stoneDB.png">
<link rel="mask-icon" href="/img/stoneDB.png" color="rgb(62, 204, 94)">
<meta name="msapplication-TileImage" content="/img/stoneDB.png">
<meta name="msapplication-TileColor" content="#000"><title data-rh="true">Architecture | StoneDB</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://stonedb.io/docs/about-stonedb/architecture"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Architecture | StoneDB"><meta data-rh="true" name="description" content="StoneDB_V1.0"><meta data-rh="true" property="og:description" content="StoneDB_V1.0"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://stonedb.io/docs/about-stonedb/architecture"><link data-rh="true" rel="alternate" href="https://stonedb.io/docs/about-stonedb/architecture" hreflang="en"><link data-rh="true" rel="alternate" href="https://stonedb.io/zh/docs/about-stonedb/architecture" hreflang="zh"><link data-rh="true" rel="alternate" href="https://stonedb.io/docs/about-stonedb/architecture" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.cee48ecd.css">
<link rel="preload" href="/assets/js/runtime~main.bd218c17.js" as="script">
<link rel="preload" href="/assets/js/main.e6a45426.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/logo_stonedb.svg" alt="StoneDB" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_stonedb.svg" alt="StoneDB" class="themedImage_ToTc themedImage--dark_i4oU"></div><span class="navbar__title text--truncate">Home</span></a><a class="navbar__item navbar__link" href="/docs/download">Download</a><a class="navbar__item navbar__link" href="/docs/about-stonedb/intro">Docs</a><a class="navbar__item navbar__link" href="/community/main">Community</a></div><div class="navbar__items navbar__items--right"><div class="ant-space ant-space-horizontal ant-space-align-center styles__GithubStyle-sc-gz8zhn-0 fMOuum hideInMobile"><div class="ant-space-item" style="margin-right:8px"></div><div class="ant-space-item"></div></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><span role="img" class="anticon undefined icon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false"><use xlink:href="#icon-a-bianzu9"></use></svg></span>English</a><ul class="dropdown__menu"><li><a href="/docs/about-stonedb/architecture" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/zh/docs/about-stonedb/architecture" target="_self" rel="noopener noreferrer" class="dropdown__link">简体中文</a></li></ul></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" target="_self" href="/"><img src="/img/logo_stonedb.svg" alt="StoneDB" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_stonedb.svg" alt="StoneDB" class="themedImage_ToTc themedImage--dark_i4oU"><span>Home</span></a><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/about-stonedb/intro">About StoneDB</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/about-stonedb/intro">StoneDB Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/about-stonedb/architecture">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/about-stonedb/limits">Limits</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/about-stonedb/terms">Terms</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/environment-requirements/supported-servers-and-OSs">Environment Requirements</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/getting-started/quick-deployment">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/O&amp;M-Guide/regular-change-operations">O&amp;M Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/compiling-methods">Developer Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/SQL-reference/character-sets">SQL Reference</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/performance-tuning/overview">Performance Tuning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/data-migration-to-stonedb/use-outter-to-migrate">Data Migration to StoneDB</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/troubleshooting/failed-to-start">Troubleshooting</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/FAQ/install-faq">FAQ</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/release-notes">Release Notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/download">Downloads</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">About StoneDB</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Architecture</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Architecture</h1><p></p><div src="/assets/images/stonedb-V1-4459aa2fedfb1f7b8baa5b9d3b31f0a8.png" class="styles__ImageStyle-sc-11e40cw-0 jASsjF" loading="lazy" alt="StoneDB_V1.0" height="auto" width="auto"><div class="styles__Title-sc-11e40cw-2 dTErME"><span></span></div><div class="styles__Mask-sc-11e40cw-1 fykhtF mask"></div></div><p></p><p>StoneDB is a hybrid transaction/analytical processing (HTAP) database. It provides a column-based storage engine also named StoneDB to handle online analytical processing (OLAP) workloads. The StoneDB storage engine features high performance and high data compression ratio, in addition to common features provided by other storage engines such as InnoDB and MyISAM. The logical architecture of StoneDB consists of three layers: applications, services, and storage engine. When an SQL query is processed by StoneDB, the SQL query is processed through every module in the three layers one after one.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p> In this topic, StoneDB refers to the database, unless otherwise specified.</p></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="applications-layer">Applications layer<a class="hash-link" href="#applications-layer" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="connection-management">Connection management<a class="hash-link" href="#connection-management" title="Direct link to heading">​</a></h3><p>When a client sends a connection request to a server, the server assigns a thread from the thread pool to process interactions with the client. If the client disconnects from the server, the thread is assigned to a new connection, instead of being destroyed. This saves time in creating and releasing threads.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="authentication">Authentication<a class="hash-link" href="#authentication" title="Direct link to heading">​</a></h3><p>After receiving a connection request from a client, the server authenticates the user that initiates the connection based on the username, password, IP address, and port number. If the user fails the authentication, the server rejects the connection request.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="access-control">Access control<a class="hash-link" href="#access-control" title="Direct link to heading">​</a></h3><p>After the client is connected to the server, the server identifies what operations are allowed for the user based on the permissions granted to the user.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="services-layer">Services layer<a class="hash-link" href="#services-layer" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="management--utilities">Management &amp; Utilities<a class="hash-link" href="#management--utilities" title="Direct link to heading">​</a></h3><p>StoneDB provides various database management features, such as backup, recovery, user management, permission management, and database metadata management.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="sql-interface">SQL Interface<a class="hash-link" href="#sql-interface" title="Direct link to heading">​</a></h3><p>SQL Interface is mainly used to receive and process SQL queries and return query results.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cache--buffers">Cache &amp; Buffers<a class="hash-link" href="#cache--buffers" title="Direct link to heading">​</a></h3><p>The query cache is used to temporarily store the hash values and result sets of executed SQL statements to enhance execution efficiency. When a query passes through this module, the hash value of the query is used to check if any matching record exists in the query cache. If no, the query is then parsed, optimized, and executed. After it is processed, its hash value and result set are cached. If yes, the result set is directly read from the cache. However, if the query hits the cache but the schema or data of the queried table is modified, the relevant cache is invalid and the query still needs to be further processed to obtain the result set. Therefore, we recommend that you disable the query cache in your production environment. The query cache is removed in MySQL 8.0.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="parser">Parser<a class="hash-link" href="#parser" title="Direct link to heading">​</a></h3><p>The parser is used to parse SQL statements and generate parse trees. The parser performs lexical analysis to check whether the table and columns exist and then syntax analysis to check whether SQL statements are written in correct syntax. If any error is detected, relevant error information will be returned.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="optimizer">Optimizer<a class="hash-link" href="#optimizer" title="Direct link to heading">​</a></h3><p>The optimizer chooses the execution plan with the lowest cost for each SQL query based on the tables, indexes, and other statistics information relevant to the SQL query.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="executor">Executor<a class="hash-link" href="#executor" title="Direct link to heading">​</a></h3><p>The executor verifies whether the user that initiates a query has permissions to operate on the relevant tables. If the user has sufficient permissions, the executor calls API operations to read data and returns the query result.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="storage-engine-layer">Storage engine layer<a class="hash-link" href="#storage-engine-layer" title="Direct link to heading">​</a></h2><p>When your data volume reaches tens of or even hundreds of billions of records, executing a statistical or aggregate query on MySQL or another relational database may take several to dozens of minutes. However, to process the same query, StoneDB requires only one tenth of the time or even less. This is because StoneDB uses column-based storage, data compression, and knowledge grid techniques to optimize query processing.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="stonedb-optimizer">StoneDB Optimizer<a class="hash-link" href="#stonedb-optimizer" title="Direct link to heading">​</a></h3><p>StoneDB Optimizer is a self-developed optimizer provided by StoneDB. It is used to optimize SQL statements by converting expressions, converting subqueries to joins, and then generates a high-efficiency execution plan by using the Knowledge Grid technique.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="stonedb-executor">StoneDB Executor<a class="hash-link" href="#stonedb-executor" title="Direct link to heading">​</a></h3><p>StoneDB Executor reads data based on the execution plan.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="knowledge-grid-manager">Knowledge Grid Manager<a class="hash-link" href="#knowledge-grid-manager" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="data-pack">Data Pack<a class="hash-link" href="#data-pack" title="Direct link to heading">​</a></h4><p>Data Packs are data storage units. Data in each column is sliced into Data Packs every 65,536 rows. A Data Pack is smaller than a column and supports higher data compression ratio, whereas it is larger than a row and supports higher query performance. Data Packs are also the units for which the Knowledge Grid uses to decompress data.</p><p>Based on the theory of rough sets, Data Packs can be classified into the following three categories:</p><ul><li>Irrelevant Data Packs: with no data elements relevant for further execution</li><li>Relevant Data Packs: with all data elements relevant for further execution</li><li>Suspect Data Packs: with some data elements relevant for further execution</li></ul><p>This classification help filter out irrelevant Data Packs. StoneDB needs only to decompress suspect Data Packs and then examine the data records to filter relevant data records, effectively improving query performance.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="data-pack-node">Data Pack Node<a class="hash-link" href="#data-pack-node" title="Direct link to heading">​</a></h4><p>A Data Pack Node stores the following information about a Data Pack:</p><ul><li>The maximum, minimum, average, and sum of the values</li><li>The number of values and the number of non-null values</li><li>The compression method</li><li>The length in byte</li></ul><p>Therefore, Data Pack Node is also called Metadata Node. One Data Pack Node corresponds to one Data Pack.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="knowledge-nod">Knowledge Nod<a class="hash-link" href="#knowledge-nod" title="Direct link to heading">​</a></h4><p>Knowledge Nodes are at the upper layer of Data Pack Nodes. Knowledge Nodes store a collection of metadata that shows the relations between Data Packs and columns, including the range of value occurrence and the associations between columns. Most data stored in a Knowledge Node is generated when data is being loaded and the rest is generated during queries. </p><p>Knowledge Nodes can be classified into the following types:</p><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="histogram"><strong>Histogram</strong><a class="hash-link" href="#histogram" title="Direct link to heading">​</a></h5><p>Histograms are used to present statistics on columns whose data types are integer, date and time, or floating point. In a histogram, the range between the maximum value and minimum value of a data pack is evenly divided into 1,024 ranges, each of which occupies 1 bit. Ranges within which at least one value falls are marked with 1. Ranges within which no value falls are marked with 0. Histograms are automatically created when data is being loaded.</p><p>Suppose values in a Data Pack fall within two ranges: 0‒100 and 102301‒102400, as shown in the following histogram.</p><table><thead><tr><th>0‒100</th><th>101‒200</th><th>201‒300</th><th>...</th><th>102301‒102400</th></tr></thead><tbody><tr><td>1</td><td>0</td><td>0</td><td>...</td><td>1</td></tr></tbody></table><p>Execute the following SQL statement:</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">select</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">table</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">where</span><span class="token plain"> id</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token number" style="color:rgb(247, 140, 108)">199</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">and</span><span class="token plain"> id</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token number" style="color:rgb(247, 140, 108)">299</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>No value in the Data Pack is hit. Therefore, the Data Pack is irrelevant and filtered out.</p><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cmap"><strong>CMAP</strong><a class="hash-link" href="#cmap" title="Direct link to heading">​</a></h5><p>Character Maps (CMAPs) are binary representation of the occurrence of ASCII characters within the first 64 row positions. If a character exists in a position, the position is marked with 1 for the character. Otherwise, the position is marked with 0 for the character. CMAPs are automatically created when data is being loaded.</p><p>In the following example, character A exists in position 1 and position 64.</p><table><thead><tr><th>Char/Char pos</th><th>1</th><th>2</th><th>...</th><th>64</th></tr></thead><tbody><tr><td>A</td><td>1</td><td>0</td><td>...</td><td>1</td></tr><tr><td>B</td><td>0</td><td>1</td><td>...</td><td>0</td></tr><tr><td>C</td><td>1</td><td>1</td><td>...</td><td>1</td></tr><tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr></tbody></table><h5 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pack-to-pack"><strong>Pack-to-Pack</strong><a class="hash-link" href="#pack-to-pack" title="Direct link to heading">​</a></h5><p>Pack-to-Packs are equijoin relations between the pairs of tables. Pack-to-Pack is a binary matrix. If a matching pair is found between two Data Packs, the value is 1. Otherwise, the value is 0. Using Pack-to-Packs can help quickly identify relevant Data Packs, improving join performance. Pack-to-Packs are automatically created when join queries are being executed.</p><p>In the following example, the condition for joining tables is <code>A.C=B.D</code>. For Data Pack A.C1, only Data Packs B.D2 and B.D5 contain matching values.</p><table><thead><tr><th></th><th>B.D1</th><th>B.D2</th><th>B.D3</th><th>B.D4</th><th>B.D5</th></tr></thead><tbody><tr><td>A.C1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td></tr><tr><td>A.C2</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>A.C3</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td></tr></tbody></table><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="knowledge-grid">Knowledge Grid<a class="hash-link" href="#knowledge-grid" title="Direct link to heading">​</a></h4><p>The Knowledge Grid consists of Data Pack Nodes and Knowledge Nodes. Data Packs are compressed for storage and the cost for decompressing Data Packs is high. Therefore, the key to improving read performance is to retrieve as few as Data Packs. The Knowledge Grid can help filter out irrelevant data. With the Knowledge Gid, the data retrieved can be reduced to less than 1% of the total data. In most cases, the data retrieved can be loaded to memory so that the query processing efficiency can be further improved.</p><p>For most statistical and aggregate queries, StoneDB can return query results by using only the Knowledge Grid. In this way, the number of Data Packs to be decompressed is greatly reduced, saving I/O resources, minimizing the response time, and improving the network utilization.</p><p><strong>Following is an example showing how the Knowledge Grid works.</strong></p><p>The following table shows the distribution of values recorded in Data Pack Nodes.</p><table><thead><tr><th></th><th>Min.</th><th>Max.</th></tr></thead><tbody><tr><td>t1.A1</td><td>1</td><td>9</td></tr><tr><td>t1.A2</td><td>10</td><td>30</td></tr><tr><td>t1.A3</td><td>40</td><td>100</td></tr></tbody></table><p>The following SQL statement is executed.</p><div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">select</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">min</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">t2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">D</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> t1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">t2 </span><span class="token keyword" style="font-style:italic">where</span><span class="token plain"> t1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">B</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">t2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">C </span><span class="token operator" style="color:rgb(137, 221, 255)">and</span><span class="token plain"> t1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">A</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token number" style="color:rgb(247, 140, 108)">15</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The working process of the Knowledge Grid is as follows:</p><ol><li>Filter Data Packs based on Data Pack Nodes: data pack t1.A1 is irrelevant, t1.A2 is suspect, and t1.A3 is relevant. Therefore, t1.A1 is filtered out.</li></ol><table><thead><tr><th></th><th>t2.C1</th><th>t2.C2</th><th>t2.C3</th><th>t2.C4</th><th>t2.C5</th></tr></thead><tbody><tr><td>t1.B1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td></tr><tr><td>t1.B2</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>t1.B3</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td></tr></tbody></table><ol start="2"><li>Compare t1.B1 and t2.C1 to check whether matching pairs exist based on pack-to-packs. In this step, Data Packs t2.C2 and t2.C5 contain matching pairs while Data Packs t2.C3 and t2.C4 are filtered out.</li></ol><table><thead><tr><th></th><th>Min.</th><th>Max.</th></tr></thead><tbody><tr><td>t2.D1</td><td>0</td><td>500</td></tr><tr><td>t2.D2</td><td>101</td><td>440</td></tr><tr><td>t2.D3</td><td>300</td><td>6879</td></tr><tr><td>t2.D4</td><td>1</td><td>432</td></tr><tr><td>t2.D5</td><td>3</td><td>100</td></tr></tbody></table><ol start="3"><li>Examine Data Packs D2 and D5, after D1, D3, and D4 are filtered out in the previous two steps. Based on the Data Pack Nodes of column D, the maximum value in D5 is 100, which is smaller than the minimum value 101 in D2. Therefore, D2 is filtered out. Now, the system only needs to decompress data pack D5 to obtain the final result.</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="stonedb-loader-parser">StoneDB Loader Parser<a class="hash-link" href="#stonedb-loader-parser" title="Direct link to heading">​</a></h3><p>StoneDB Loader Parser is a module responsible for data import and export. It processes <code>LOAD DATA INFILE</code> and <code>SELECT … INTO FILE</code> operations.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="insert-buffer">Insert Buffer<a class="hash-link" href="#insert-buffer" title="Direct link to heading">​</a></h3><p>The Insert Buffer is used to optimize insert performance. When you insert data to a table, the data to insert is first temporarily stored in Insert Buffer and then flushed from Insert Buffer to disks in batches. This improves system throughput. If the data is directly written into disks, the data is written one row after another because StoneDB does not support transactions. As a result, the system throughput is low and thus the insertion efficiency is low. Insert Buffer is enabled by default. If you want to disable it, set parameter <strong>stonedb_insert_delayed</strong> to <strong>off</strong>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="replication-manager">Replication Manager<a class="hash-link" href="#replication-manager" title="Direct link to heading">​</a></h3><p>The high-availability structure of StoneDB includes a replication engine called Replication Manager to ensure strong consistency between the primary and secondary databases. Different from binlog replication used by MySQL to replicate original data, Replication Manager can directly replicate compressed data since data stored in StoneDB is compressed, without the need for decompression. This greatly reduces the traffic required for transmitting data.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="compress">Compress<a class="hash-link" href="#compress" title="Direct link to heading">​</a></h3><p>Compress is the module for compressing data and supports more than 20 compression algorithms such as PPM, LZ4, B2, and Delta. In StoneDB, data is stored by column. Since data records stored in a column are of the same data type, StoneDB can dynamically choose the most efficient compression algorithm based on the data type defined for the column. More repeated values in a column indicates higher compression ratio of the column. Compression not only saves storage space but also I/O and memory resources.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="decompress">Decompress<a class="hash-link" href="#decompress" title="Direct link to heading">​</a></h3><p>Decompress is the module for decompressing data. The unit for compression and decompression is Data Pack. With the Knowledge Grid technique, StoneDB first filters out irrelevant Data Packs, and then decompresses and examines suspect Data Packs, and then obtains the final query result.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/stoneatom/stonedb/edit/stonedb-5.7/../Docs/00-about-stonedb/architecture.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eYIM" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vbeJ"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-07-14T03:01:21.000Z">7/14/2022</time></b> by <b>hustjieke</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/about-stonedb/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">StoneDB Introduction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/about-stonedb/limits"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Limits</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#applications-layer" class="table-of-contents__link toc-highlight">Applications layer</a><ul><li><a href="#connection-management" class="table-of-contents__link toc-highlight">Connection management</a></li><li><a href="#authentication" class="table-of-contents__link toc-highlight">Authentication</a></li><li><a href="#access-control" class="table-of-contents__link toc-highlight">Access control</a></li></ul></li><li><a href="#services-layer" class="table-of-contents__link toc-highlight">Services layer</a><ul><li><a href="#management--utilities" class="table-of-contents__link toc-highlight">Management &amp; Utilities</a></li><li><a href="#sql-interface" class="table-of-contents__link toc-highlight">SQL Interface</a></li><li><a href="#cache--buffers" class="table-of-contents__link toc-highlight">Cache &amp; Buffers</a></li><li><a href="#parser" class="table-of-contents__link toc-highlight">Parser</a></li><li><a href="#optimizer" class="table-of-contents__link toc-highlight">Optimizer</a></li><li><a href="#executor" class="table-of-contents__link toc-highlight">Executor</a></li></ul></li><li><a href="#storage-engine-layer" class="table-of-contents__link toc-highlight">Storage engine layer</a><ul><li><a href="#stonedb-optimizer" class="table-of-contents__link toc-highlight">StoneDB Optimizer</a></li><li><a href="#stonedb-executor" class="table-of-contents__link toc-highlight">StoneDB Executor</a></li><li><a href="#knowledge-grid-manager" class="table-of-contents__link toc-highlight">Knowledge Grid Manager</a></li><li><a href="#stonedb-loader-parser" class="table-of-contents__link toc-highlight">StoneDB Loader Parser</a></li><li><a href="#insert-buffer" class="table-of-contents__link toc-highlight">Insert Buffer</a></li><li><a href="#replication-manager" class="table-of-contents__link toc-highlight">Replication Manager</a></li><li><a href="#compress" class="table-of-contents__link toc-highlight">Compress</a></li><li><a href="#decompress" class="table-of-contents__link toc-highlight">Decompress</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><div class="styles__LinkItemStyle-sc-1h1kjiy-0 hDEIGG"><a href="https://twitter.com/StoneDataBase" target="_blank" rel="noopener noreferrer" class="styles__Link-sc-1h1kjiy-1 jSEJvj"><span role="img" class="anticon undefined icon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false"><use xlink:href="#icon-a-bianzu2"></use></svg></span></a></div><span class="footer__link-separator">·</span><div class="styles__LinkItemStyle-sc-1h1kjiy-0 hDEIGG"><a class="styles__Link-sc-1h1kjiy-1 jSEJvj"><span role="img" class="anticon undefined icon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false"><use xlink:href="#icon-a-bianzu17beifen2"></use></svg></span></a></div><span class="footer__link-separator">·</span><div class="styles__LinkItemStyle-sc-1h1kjiy-0 hDEIGG"><a href="https://stonedb.slack.com/join/shared_invite/zt-1ba2lpvbo-Vqq62DJcxViyxCZmp7Rimw#/shared-invite/email" target="_blank" rel="noopener noreferrer" class="styles__Link-sc-1h1kjiy-1 jSEJvj"><span role="img" class="anticon undefined icon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false"><use xlink:href="#icon-a-bianzu18beifen2"></use></svg></span></a></div><span class="footer__link-separator">·</span><div class="styles__LinkItemStyle-sc-1h1kjiy-0 hDEIGG"><a href="https://github.com/StoneAtom/stonedb" target="_blank" rel="noopener noreferrer" class="styles__Link-sc-1h1kjiy-1 jSEJvj"><span role="img" class="anticon undefined icon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false"><use xlink:href="#icon-a-bianzu4"></use></svg></span></a></div></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © The StoneAtom-tech ALL Rights Reserved</div></div></div></footer></div>
<script src="/assets/js/runtime~main.bd218c17.js"></script>
<script src="/assets/js/main.e6a45426.js"></script>
</body>
</html>